<?xml version="1.0" encoding="UTF-8"?>
<!--
  migration-overview.svg
  High-level migration flow: Flink 1.20 (Java) → Spark 4.1 RTM (Python)
  Shows 4 patterns as migration arrows between engine panels.
  Canvas: 1200 × 700  |  Background: #1a1a2e  |  Flink: #E6526F  |  Spark: #00d4aa
-->
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 700" width="1200" height="700"
     role="img" aria-label="Migration overview: Flink 1.20 to Spark 4.1 Real-Time Mode">

  <defs>
    <!-- Background gradient -->
    <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#16213e;stop-opacity:1"/>
    </linearGradient>

    <!-- Flink panel gradient -->
    <linearGradient id="flinkPanelGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#2a1a22;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#1e1628;stop-opacity:1"/>
    </linearGradient>

    <!-- Spark panel gradient -->
    <linearGradient id="sparkPanelGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#0d2b28;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#0a1f2e;stop-opacity:1"/>
    </linearGradient>

    <!-- Arrow marker – Kafka orange -->
    <marker id="arrowKafka" markerWidth="10" markerHeight="7"
            refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ff6b35"/>
    </marker>

    <!-- Arrow marker – migration teal -->
    <marker id="arrowMigrate" markerWidth="10" markerHeight="7"
            refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#00d4aa"/>
    </marker>

    <!-- Arrow marker – purple -->
    <marker id="arrowPurple" markerWidth="10" markerHeight="7"
            refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#7c3aed"/>
    </marker>

    <!-- Drop shadow filter -->
    <filter id="shadow" x="-5%" y="-5%" width="110%" height="110%">
      <feDropShadow dx="0" dy="4" stdDeviation="8" flood-color="#000000" flood-opacity="0.4"/>
    </filter>

    <!-- Glow filter for Flink -->
    <filter id="glowFlink" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur stdDeviation="4" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>

    <!-- Glow filter for Spark -->
    <filter id="glowSpark" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur stdDeviation="4" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
  </defs>

  <!-- ── Canvas background ── -->
  <rect width="1200" height="700" fill="url(#bgGrad)"/>

  <!-- Subtle grid overlay -->
  <g opacity="0.04" stroke="#ffffff" stroke-width="1">
    <line x1="0" y1="100" x2="1200" y2="100"/>
    <line x1="0" y1="200" x2="1200" y2="200"/>
    <line x1="0" y1="300" x2="1200" y2="300"/>
    <line x1="0" y1="400" x2="1200" y2="400"/>
    <line x1="0" y1="500" x2="1200" y2="500"/>
    <line x1="0" y1="600" x2="1200" y2="600"/>
    <line x1="200" y1="0" x2="200" y2="700"/>
    <line x1="400" y1="0" x2="400" y2="700"/>
    <line x1="600" y1="0" x2="600" y2="700"/>
    <line x1="800" y1="0" x2="800" y2="700"/>
    <line x1="1000" y1="0" x2="1000" y2="700"/>
  </g>

  <!-- ══════════════════════════════════════════
       HEADER
  ══════════════════════════════════════════ -->
  <text x="600" y="52" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="26" font-weight="700" fill="#ffffff" text-anchor="middle"
        letter-spacing="0.5">Flink to Spark 4.1 Real-Time Mode</text>
  <text x="600" y="76" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="14" font-weight="400" fill="#8892a4" text-anchor="middle"
        letter-spacing="0.3">Migration Overview  ·  4 Streaming Patterns</text>

  <!-- Header separator -->
  <line x1="80" y1="92" x2="1120" y2="92" stroke="#2d3a52" stroke-width="1"/>

  <!-- ══════════════════════════════════════════
       LEFT PANEL — Flink 1.20
  ══════════════════════════════════════════ -->
  <rect x="40" y="108" width="340" height="548" rx="14" ry="14"
        fill="url(#flinkPanelGrad)" stroke="#E6526F" stroke-width="1.5"
        filter="url(#shadow)"/>

  <!-- Flink panel header bar -->
  <rect x="40" y="108" width="340" height="56" rx="14" ry="14"
        fill="#E6526F" opacity="0.15"/>
  <rect x="40" y="136" width="340" height="28" fill="#E6526F" opacity="0.15"/>

  <!-- Flink logo mark (simplified F hexagon) -->
  <polygon points="100,125 110,119 120,125 120,137 110,143 100,137"
           fill="#E6526F" opacity="0.9"/>
  <text x="110" y="136" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="12" font-weight="700" fill="#1a1a2e" text-anchor="middle">F</text>

  <text x="220" y="130" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="18" font-weight="700" fill="#E6526F" text-anchor="middle"
        letter-spacing="0.5">Apache Flink 1.20</text>
  <text x="220" y="150" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="12" font-weight="400" fill="#c97a8a" text-anchor="middle">Java  ·  DataStream API</text>

  <!-- Flink pattern boxes -->
  <!-- Pattern 01 -->
  <rect x="64" y="188" width="292" height="98" rx="8" ry="8"
        fill="#1e1628" stroke="#E6526F" stroke-width="1" stroke-opacity="0.5"/>
  <rect x="64" y="188" width="6" height="98" rx="3" ry="3" fill="#E6526F"/>
  <text x="82" y="208" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" font-weight="700" fill="#E6526F" letter-spacing="1.5">01  STATELESS</text>
  <text x="82" y="226" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="14" font-weight="600" fill="#ffffff">Stateless Passthrough</text>
  <text x="82" y="246" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">FlatMapFunction</text>
  <text x="82" y="263" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">.filter(type → "click")</text>
  <text x="82" y="278" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" fill="#8892a4">Latency: sub-ms p99</text>

  <!-- Pattern 02 -->
  <rect x="64" y="302" width="292" height="98" rx="8" ry="8"
        fill="#1e1628" stroke="#E6526F" stroke-width="1" stroke-opacity="0.5"/>
  <rect x="64" y="302" width="6" height="98" rx="3" ry="3" fill="#E6526F"/>
  <text x="82" y="322" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" font-weight="700" fill="#E6526F" letter-spacing="1.5">02  TUMBLING WINDOW</text>
  <text x="82" y="340" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="14" font-weight="600" fill="#ffffff">Tumbling Window Count</text>
  <text x="82" y="360" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">TumblingEventTimeWindows</text>
  <text x="82" y="377" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">.of(Time.minutes(1))</text>
  <text x="82" y="392" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" fill="#8892a4">keyBy → window → aggregate</text>

  <!-- Pattern 03 -->
  <rect x="64" y="416" width="292" height="98" rx="8" ry="8"
        fill="#1e1628" stroke="#E6526F" stroke-width="1" stroke-opacity="0.5"/>
  <rect x="64" y="416" width="6" height="98" rx="3" ry="3" fill="#E6526F"/>
  <text x="82" y="436" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" font-weight="700" fill="#E6526F" letter-spacing="1.5">03  SLIDING WINDOW</text>
  <text x="82" y="454" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="14" font-weight="600" fill="#ffffff">Sliding Window Average</text>
  <text x="82" y="474" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">SlidingEventTimeWindows</text>
  <text x="82" y="491" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">.of(5min, 1min)</text>
  <text x="82" y="506" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" fill="#8892a4">keyBy → window → avg()</text>

  <!-- Pattern 04 -->
  <rect x="64" y="530" width="292" height="98" rx="8" ry="8"
        fill="#1e1628" stroke="#E6526F" stroke-width="1" stroke-opacity="0.5"/>
  <rect x="64" y="530" width="6" height="98" rx="3" ry="3" fill="#E6526F"/>
  <text x="82" y="550" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" font-weight="700" fill="#E6526F" letter-spacing="1.5">04  KEYED STATE</text>
  <text x="82" y="568" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="14" font-weight="600" fill="#ffffff">Keyed State Counter</text>
  <text x="82" y="588" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">KeyedProcessFunction</text>
  <text x="82" y="605" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">+ ValueState&lt;Integer&gt;</text>
  <text x="82" y="620" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" fill="#8892a4">Semantic diff from Spark</text>

  <!-- ══════════════════════════════════════════
       CENTRE MIGRATION CHANNEL
  ══════════════════════════════════════════ -->
  <!-- Central "MIGRATE" column label -->
  <text x="600" y="106" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" font-weight="600" fill="#2d3a52" text-anchor="middle"
        letter-spacing="2">MIGRATION PATHS</text>

  <!-- Arrow row 01 - stateless - teal solid -->
  <line x1="392" y1="237" x2="802" y2="237"
        stroke="#00d4aa" stroke-width="2.5" stroke-dasharray="none"
        marker-end="url(#arrowMigrate)"/>
  <rect x="550" y="221" width="100" height="24" rx="4" fill="#0a2a28" stroke="#00d4aa" stroke-width="1"/>
  <text x="600" y="237" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" font-weight="700" fill="#00d4aa" text-anchor="middle"
        letter-spacing="0.5">DIRECT MAP</text>

  <!-- Arrow row 02 - tumbling - teal dashed -->
  <line x1="392" y1="351" x2="802" y2="351"
        stroke="#00d4aa" stroke-width="2.5" stroke-dasharray="8 4"
        marker-end="url(#arrowMigrate)"/>
  <rect x="546" y="335" width="108" height="24" rx="4" fill="#0a2a28" stroke="#00d4aa" stroke-width="1"/>
  <text x="600" y="351" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" font-weight="700" fill="#00d4aa" text-anchor="middle"
        letter-spacing="0.5">API MAPPING</text>

  <!-- Arrow row 03 - sliding - teal dashed -->
  <line x1="392" y1="465" x2="802" y2="465"
        stroke="#00d4aa" stroke-width="2.5" stroke-dasharray="8 4"
        marker-end="url(#arrowMigrate)"/>
  <rect x="546" y="449" width="108" height="24" rx="4" fill="#0a2a28" stroke="#00d4aa" stroke-width="1"/>
  <text x="600" y="465" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" font-weight="700" fill="#00d4aa" text-anchor="middle"
        letter-spacing="0.5">API MAPPING</text>

  <!-- Arrow row 04 - keyed state - purple (semantic diff) -->
  <line x1="392" y1="579" x2="802" y2="579"
        stroke="#7c3aed" stroke-width="2.5" stroke-dasharray="5 5"
        marker-end="url(#arrowPurple)"/>
  <rect x="534" y="563" width="132" height="24" rx="4" fill="#1a0a2e" stroke="#7c3aed" stroke-width="1"/>
  <text x="600" y="579" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" font-weight="700" fill="#7c3aed" text-anchor="middle"
        letter-spacing="0.5">SEMANTIC DIFF</text>

  <!-- Legend dots -->
  <circle cx="460" cy="652" r="5" fill="#00d4aa"/>
  <text x="470" y="656" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="11" fill="#8892a4">Direct / API mapping</text>
  <circle cx="590" cy="652" r="5" fill="#7c3aed"/>
  <text x="600" y="656" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="11" fill="#8892a4">Semantic difference</text>
  <line x1="705" y1="652" x2="730" y2="652"
        stroke="#00d4aa" stroke-width="2" stroke-dasharray="8 4"/>
  <text x="735" y="656" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="11" fill="#8892a4">Stateful</text>

  <!-- ══════════════════════════════════════════
       RIGHT PANEL — Spark 4.1 RTM
  ══════════════════════════════════════════ -->
  <rect x="820" y="108" width="340" height="548" rx="14" ry="14"
        fill="url(#sparkPanelGrad)" stroke="#00d4aa" stroke-width="1.5"
        filter="url(#shadow)"/>

  <!-- Spark panel header bar -->
  <rect x="820" y="108" width="340" height="56" rx="14" ry="14"
        fill="#00d4aa" opacity="0.12"/>
  <rect x="820" y="136" width="340" height="28" fill="#00d4aa" opacity="0.12"/>

  <!-- Spark logo mark (simplified S circle) -->
  <circle cx="875" cy="131" r="14" fill="#00d4aa" opacity="0.2" stroke="#00d4aa" stroke-width="1.5"/>
  <text x="875" y="136" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="13" font-weight="800" fill="#00d4aa" text-anchor="middle">S</text>

  <text x="1000" y="130" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="18" font-weight="700" fill="#00d4aa" text-anchor="middle"
        letter-spacing="0.5">Apache Spark 4.1 RTM</text>
  <text x="1000" y="150" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="12" font-weight="400" fill="#4da89a" text-anchor="middle">Python  ·  DataFrame API  ·  Real-Time Mode</text>

  <!-- Spark pattern boxes -->
  <!-- Pattern 01 -->
  <rect x="844" y="188" width="292" height="98" rx="8" ry="8"
        fill="#0a1f2e" stroke="#00d4aa" stroke-width="1" stroke-opacity="0.5"/>
  <rect x="1130" y="188" width="6" height="98" rx="3" ry="3" fill="#00d4aa"/>
  <text x="856" y="208" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" font-weight="700" fill="#00d4aa" letter-spacing="1.5">01  STATELESS</text>
  <text x="856" y="226" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="14" font-weight="600" fill="#ffffff">readStream → filter</text>
  <text x="856" y="246" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">.filter(col("type").isin(...))</text>
  <text x="856" y="263" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">.writeStream.format("kafka")</text>
  <text x="856" y="278" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" fill="#8892a4">Latency: 5–15 ms p99</text>

  <!-- Pattern 02 -->
  <rect x="844" y="302" width="292" height="98" rx="8" ry="8"
        fill="#0a1f2e" stroke="#00d4aa" stroke-width="1" stroke-opacity="0.5"/>
  <rect x="1130" y="302" width="6" height="98" rx="3" ry="3" fill="#00d4aa"/>
  <text x="856" y="322" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" font-weight="700" fill="#00d4aa" letter-spacing="1.5">02  TUMBLING WINDOW</text>
  <text x="856" y="340" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="14" font-weight="600" fill="#ffffff">window() + groupBy</text>
  <text x="856" y="360" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">window(col("event_time"), "1 minute")</text>
  <text x="856" y="377" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">.agg(count("*"))</text>
  <text x="856" y="392" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" fill="#8892a4">groupBy → window() → agg()</text>

  <!-- Pattern 03 -->
  <rect x="844" y="416" width="292" height="98" rx="8" ry="8"
        fill="#0a1f2e" stroke="#00d4aa" stroke-width="1" stroke-opacity="0.5"/>
  <rect x="1130" y="416" width="6" height="98" rx="3" ry="3" fill="#00d4aa"/>
  <text x="856" y="436" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" font-weight="700" fill="#00d4aa" letter-spacing="1.5">03  SLIDING WINDOW</text>
  <text x="856" y="454" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="14" font-weight="600" fill="#ffffff">window() + slide arg</text>
  <text x="856" y="474" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">window(col("et"), "5 min", "1 min")</text>
  <text x="856" y="491" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">.agg(avg("value"))</text>
  <text x="856" y="506" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" fill="#8892a4">groupBy → window(size, slide) → agg()</text>

  <!-- Pattern 04 -->
  <rect x="844" y="530" width="292" height="98" rx="8" ry="8"
        fill="#0a1f2e" stroke="#7c3aed" stroke-width="1" stroke-opacity="0.7"/>
  <rect x="1130" y="530" width="6" height="98" rx="3" ry="3" fill="#7c3aed"/>
  <text x="856" y="550" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" font-weight="700" fill="#7c3aed" letter-spacing="1.5">04  KEYED STATE</text>
  <text x="856" y="568" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="14" font-weight="600" fill="#ffffff">transformWithState</text>
  <text x="856" y="588" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">StatefulProcessor</text>
  <text x="856" y="605" font-family="'Courier New', Courier, monospace"
        font-size="11" fill="#a0a8b8">+ handle.getValueState()</text>
  <text x="856" y="620" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="10" fill="#8892a4">Latency: 100–300 ms p99</text>

  <!-- ══════════════════════════════════════════
       FOOTER  caption
  ══════════════════════════════════════════ -->
  <text x="600" y="678" font-family="'Helvetica Neue', Arial, sans-serif"
        font-size="11" font-style="italic" fill="#4a5568" text-anchor="middle">
    Figure 1. Migration flow from Apache Flink 1.20 (Java DataStream API) to Apache Spark 4.1 Real-Time Mode (PySpark DataFrame API)
  </text>
</svg>
